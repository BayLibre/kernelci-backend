Test Code Coverage
==================

To have a test coverage report, install the `coverage` package via pip, and
then execute:

  cd app/
  coverage run -m unittest tests.test_suite 2>/dev/null && coverage html

The output will be stored in the `kernel-ci-backend-coverage` directory.

Ansible Local Deployment
========================

In the repository ansible hosts file, a local host is defined and is called
`kernel-ci-backend`. This host is provided to perform local deployment using
ansible:

  ansible-playbook -i hosts site.yml -l local -c local -K --skip-tags=secrets

If you already have a file with all the necessary secrets variable:

  ansible-playbook -i hosts site.yml -l local -c local -K -e "@/path/to/secrets.yml"

This will deploy the kernel-ci backend code into `/srv/kernel-ci-backend/`,
intall all dependencies and set up an nginx host called `kernel-ci-backend`.

If all you need is accessing the backend and its APIs through localhost, skip
all the nginx related tasks:

  ansible-playbook -i hosts site.yml -l local -c local -K --skip-tags=web-server

By default an S3-backup shell script and firewall rules via `ufw` will be
installed as well. Skip them with:

  --skip-tags=backup,firewall
